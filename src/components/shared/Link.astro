---
import { getLangFromUrl, useTranslatedPath } from "@i18n/utils";

interface Props {
  href: string;
  name: string;
}

const { href, name } = Astro.props;
const currentPath = Astro.url.pathname;

// Detectar el idioma actual de la URL
const currentLang = getLangFromUrl(new URL(currentPath, Astro.url));

// Generar la ruta traducida, evitando duplicar prefijos
const translatePath = useTranslatedPath(currentLang);
const normalizedHref = href.startsWith(`/${currentLang}`)
  ? href
  : `/${currentLang}${href}`;
const localizedHref = currentLang === "en" ? href : normalizedHref;

// Verificar si la ruta es activa (rooms din√°mico incluido)
const isActive =
  currentPath === localizedHref ||
  (currentPath.includes("/rooms") && localizedHref.includes("/rooms"));
---

<li>
  <a
    class="text-textPrimary mx-4 text-xl leading-tight truncate font-semibold"
    aria-label={`Ruta a ${name}`}
    href={localizedHref}
  >
    {name}
  </a>
  {
    isActive ? (
      <div
        transition:name="menu-line"
        class="border-b-4 md:mx-4 border-azulOcean transition-all ease-in-out"
      />
    ) : (
      <div class="border-b-4 mx-4 border-transparent" />
    )
  }
</li>
